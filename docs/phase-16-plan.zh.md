# Phase 16：P2P 发现与对等节点评分

## 概述

Phase 16 添加基于对等节点交换协议的节点发现、基于声誉的对等节点评分（含封禁/解封机制）以及健康检查。

## 组件

### PeerScoring (`peer-scoring.ts`)
- 每个对等节点跟踪声誉分（0-200 范围）
- 成功交互奖励，失败/无效数据惩罚
- 分数低于阈值时自动封禁（默认 30 分钟）
- 分数随时间向初始值衰减
- 统计 API：总数、活跃、封禁、平均分

### PeerDiscovery (`peer-discovery.ts`)
- 从静态配置引导节点启动
- 周期性对等节点交换：向已知节点请求其节点列表
- 基于超时的健康检查和故障检测
- 最大节点数限制，防止资源耗尽
- 自身排除在发现结果之外

### P2P 集成 (`p2p.ts`)
- `/p2p/peers` 端点用于节点交换
- 广播使用活跃（未封禁）节点
- 评分集成到广播成功/失败跟踪中
- 发现和评分随 P2P 服务器自动启动

## 测试覆盖

- `peer-scoring.test.ts`：17 个测试（11 评分 + 6 发现）
- 所有 81 个测试通过

## 状态：已完成
